{
  "provider": {
    "name": "panther"
  },
  "resources": [
    {
      "name": "httpsource",
      "schema": {
        "attributes": [
          {
            "name": "auth_bearer_token",
            "string": {
              "computed_optional_required": "computed_optional",
              "description": "The authentication bearer token value of the http source. Used for Bearer auth method"
            }
          },
          {
            "name": "auth_header_key",
            "string": {
              "computed_optional_required": "computed_optional",
              "description": "The authentication header key of the http source. Used for HMAC and SharedSecret auth methods"
            }
          },
          {
            "name": "auth_hmac_alg",
            "string": {
              "computed_optional_required": "computed_optional",
              "description": "The authentication algorithm of the http source. Used for HMAC auth method"
            }
          },
          {
            "name": "auth_method",
            "string": {
              "computed_optional_required": "required",
              "description": "The authentication method of the http source",
              "validators": [
                {
                  "custom": {
                    "imports": [
                      {
                        "path": "github.com/hashicorp/terraform-plugin-framework-validators/stringvalidator"
                      }
                    ],
                    "schema_definition": "stringvalidator.OneOf(\n\"SharedSecret\",\n\"HMAC\",\n\"Bearer\",\n\"Basic\",\n\"None\",\n)"
                  }
                }
              ]
            }
          },
          {
            "name": "auth_password",
            "string": {
              "computed_optional_required": "computed_optional",
              "description": "The authentication header password of the http source. Used for Basic auth method"
            }
          },
          {
            "name": "auth_secret_value",
            "string": {
              "computed_optional_required": "computed_optional",
              "description": "The authentication header secret value of the http source. Used for HMAC and SharedSecret auth methods"
            }
          },
          {
            "name": "auth_username",
            "string": {
              "computed_optional_required": "computed_optional",
              "description": "The authentication header username of the http source. Used for Basic auth method"
            }
          },
          {
            "name": "integration_label",
            "string": {
              "computed_optional_required": "required",
              "description": "The integration label (name)"
            }
          },
          {
            "name": "log_stream_type",
            "string": {
              "computed_optional_required": "required",
              "description": "The log stream type. Supported log stream types: Auto, JSON, JsonArray, Lines, CloudWatchLogs, XML",
              "validators": [
                {
                  "custom": {
                    "imports": [
                      {
                        "path": "github.com/hashicorp/terraform-plugin-framework-validators/stringvalidator"
                      }
                    ],
                    "schema_definition": "stringvalidator.OneOf(\n\"Auto\",\n\"JSON\",\n\"JsonArray\",\n\"Lines\",\n\"CloudWatchLogs\",\n\"XML\",\n)"
                  }
                }
              ]
            }
          },
          {
            "name": "log_stream_type_options",
            "single_nested": {
              "computed_optional_required": "computed_optional",
              "attributes": [
                {
                  "name": "json_array_envelope_field",
                  "string": {
                    "computed_optional_required": "computed_optional",
                    "description": "Path to the array value to extract elements from, only applicable if logStreamType is JsonArray. Leave empty if the input JSON is an array itself"
                  }
                }
              ]
            }
          },
          {
            "name": "log_types",
            "list": {
              "computed_optional_required": "required",
              "element_type": {
                "string": {}
              },
              "description": "The log types of the integration"
            }
          },
          {
            "name": "id",
            "string": {
              "computed_optional_required": "computed_optional",
              "description": "ID of the http source to fetch"
            }
          }
        ]
      }
    },
    {
      "name": "rule",
      "schema": {
        "attributes": [
          {
            "name": "body",
            "string": {
              "computed_optional_required": "required",
              "description": "The python body of the rule"
            }
          },
          {
            "name": "dedup_period_minutes",
            "int64": {
              "computed_optional_required": "computed_optional",
              "default": {
                "static": 60
              },
              "description": "The amount of time in minutes for grouping alerts",
              "validators": [
                {
                  "custom": {
                    "imports": [
                      {
                        "path": "github.com/hashicorp/terraform-plugin-framework-validators/int64validator"
                      }
                    ],
                    "schema_definition": "int64validator.AtLeast(1)"
                  }
                }
              ]
            }
          },
          {
            "name": "description",
            "string": {
              "computed_optional_required": "computed_optional",
              "description": "The description of the rule"
            }
          },
          {
            "name": "display_name",
            "string": {
              "computed_optional_required": "computed_optional",
              "description": "The display name of the rule"
            }
          },
          {
            "name": "enabled",
            "bool": {
              "computed_optional_required": "computed_optional",
              "description": "Determines whether or not the rule is active"
            }
          },
          {
            "name": "inline_filters",
            "string": {
              "computed_optional_required": "computed_optional",
              "description": "The filter for the rule represented in YAML"
            }
          },
          {
            "name": "log_types",
            "list": {
              "computed_optional_required": "computed_optional",
              "element_type": {
                "string": {}
              },
              "description": "log types"
            }
          },
          {
            "name": "managed",
            "bool": {
              "computed_optional_required": "computed_optional",
              "description": "Determines if the rule is managed by panther"
            }
          },
          {
            "name": "output_ids",
            "list": {
              "computed_optional_required": "computed_optional",
              "element_type": {
                "string": {}
              },
              "description": "Destination IDs that override default alert routing based on severity"
            }
          },
          {
            "name": "reports",
            "map": {
              "computed_optional_required": "computed_optional",
              "element_type": {
                "list": {
                  "element_type": {
                    "string": {}
                  }
                }
              },
              "description": "reports"
            }
          },
          {
            "name": "runbook",
            "string": {
              "computed_optional_required": "computed_optional",
              "description": "How to handle the generated alert"
            }
          },
          {
            "name": "severity",
            "string": {
              "computed_optional_required": "required",
              "validators": [
                {
                  "custom": {
                    "imports": [
                      {
                        "path": "github.com/hashicorp/terraform-plugin-framework-validators/stringvalidator"
                      }
                    ],
                    "schema_definition": "stringvalidator.OneOf(\n\"INFO\",\n\"LOW\",\n\"MEDIUM\",\n\"HIGH\",\n\"CRITICAL\",\n)"
                  }
                }
              ]
            }
          },
          {
            "name": "summary_attributes",
            "list": {
              "computed_optional_required": "computed_optional",
              "element_type": {
                "string": {}
              },
              "description": "A list of fields in the event to create top 5 summaries for"
            }
          },
          {
            "name": "tags",
            "list": {
              "computed_optional_required": "computed_optional",
              "element_type": {
                "string": {}
              },
              "description": "The tags for the rule"
            }
          },
          {
            "name": "tests",
            "list_nested": {
              "computed_optional_required": "computed_optional",
              "nested_object": {
                "attributes": [
                  {
                    "name": "expected_result",
                    "bool": {
                      "computed_optional_required": "required",
                      "description": "The expected result"
                    }
                  },
                  {
                    "name": "mocks",
                    "list": {
                      "computed_optional_required": "computed_optional",
                      "element_type": {
                        "map": {
                          "element_type": {
                            "string": {}
                          }
                        }
                      },
                      "description": "mocks"
                    }
                  },
                  {
                    "name": "name",
                    "string": {
                      "computed_optional_required": "required",
                      "description": "name"
                    }
                  },
                  {
                    "name": "resource",
                    "string": {
                      "computed_optional_required": "required",
                      "description": "resource"
                    }
                  }
                ]
              },
              "description": "Unit tests for the Rule. Best practice is to include a positive and negative case"
            }
          },
          {
            "name": "threshold",
            "int64": {
              "computed_optional_required": "computed_optional",
              "default": {
                "static": 1
              },
              "description": "the number of events that must match before an alert is triggered",
              "validators": [
                {
                  "custom": {
                    "imports": [
                      {
                        "path": "github.com/hashicorp/terraform-plugin-framework-validators/int64validator"
                      }
                    ],
                    "schema_definition": "int64validator.AtLeast(1)"
                  }
                }
              ]
            }
          },
          {
            "name": "created_at",
            "string": {
              "computed_optional_required": "computed"
            }
          },
          {
            "name": "created_by",
            "single_nested": {
              "computed_optional_required": "computed",
              "attributes": [
                {
                  "name": "id",
                  "string": {
                    "computed_optional_required": "computed"
                  }
                },
                {
                  "name": "type",
                  "string": {
                    "computed_optional_required": "computed"
                  }
                }
              ],
              "description": "The actor who created the rule"
            }
          },
          {
            "name": "created_by_external",
            "string": {
              "computed_optional_required": "computed",
              "description": "The text of the user-provided CreatedBy field when uploaded via CI/CD"
            }
          },
          {
            "name": "last_modified",
            "string": {
              "computed_optional_required": "computed"
            }
          }
        ]
      }
    }
  ],
  "version": "0.1"
}
